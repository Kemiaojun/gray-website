import{d as $,j as G,E as T,f as O,g as j,b as H,c as J,h as P,i as Q}from"./element-plus-COxNbMku.js";import{a as W,l as K,d as X,b as Y}from"./link-CYb4nNZ_.js";import{G as U}from"./GWTitleImageCard-Ckk2f-I7.js";import{I as Z}from"./ImageUpload-BEJUHBTv.js";import{d as ee,r as i,b as le,H as x,c as v,a as g,L as o,M as _,a7 as w,P as t,o as m,Q as E,T as L}from"./@vue-BV9Q_yhH.js";import{_ as ae}from"./index-CWm0XY_p.js";import"./lodash-es-BDpUAi6D.js";import"./async-validator-DKvM95Vc.js";import"./@vueuse-DVUPgnhb.js";import"./dayjs-Didlxlvp.js";import"./@element-plus-DgtNr1CL.js";import"./@ctrl-D_sRHO8g.js";import"./@popperjs-D9SI2xQl.js";import"./request_website-Bk4SsOMl.js";import"./axios-Cm0UX6qg.js";import"./pinia-CWZPuNdE.js";import"./vue-router-DaOdIdNP.js";import"./vue-pdf-embed-BcRweBTn.js";const oe={class:"graython-Link-root"},re=["onClick"],te=["onClick"],ne=ee({__name:"Anchor",setup(se){const p=i(!0),y=i(),b=i(),k=i();le(async()=>{await W().then(l=>{b.value=l.data}),d()});const d=async()=>{await K(-1).then(l=>{k.value=l.data})},u=i(!1),e=x({name:"",remark:"",url:"",cover:"",coverUrl:"",groupType:0});let V;const F=x({name:[{required:!0,message:"请输入网站名称",trigger:"blur"}],remark:[{required:!0,message:"请输入网站描述",trigger:"blur"}],url:[{required:!0,message:"请输入网站链接",trigger:"blur"}]}),c=l=>{l?(e.id=l.id,e.name=l.name,e.remark=l.remark,e.url=l.url,e.cover=l.cover,e.coverUrl=l.coverUrl,e.groupType=l.groupType):(e.id=void 0,e.name="",e.remark="",e.url="",e.cover="",e.coverUrl=void 0,e.groupType=0)},B=()=>{c(),u.value=!0},A=l=>{c(l),u.value=!0};function I(l){G.confirm("确定要删除合集["+l.name+"]吗？","确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{await X(l.id).then(()=>{d()}),T({type:"success",message:"删除成功!"})}).catch(()=>{T({type:"info",message:"取消删除"})})}const f=()=>{u.value=!1},R=async l=>{p.value&&l&&await l.validate(async(r,s)=>{if(r){p.value=!1;let n=new FormData;n.append("file",V),n.append("entity",JSON.stringify({id:e.id,name:e.name,remark:e.remark,url:e.url,cover:e.cover,groupType:e.groupType})),await Y(n).then(h=>{p.value=!0,c(),f(),d()}).finally(()=>{p.value=!0})}else console.log("error submit!",s)})},q=l=>{V=l};return(l,r)=>{const s=O,n=j,h=H,z=J,C=P,D=Q,M=$;return m(),v(_,null,[g("div",oe,[o(U,{blankCard:!0,onClick:B}),(m(!0),v(_,null,w(k.value,(a,N)=>(m(),E(U,{blankCard:!1,key:N,image:a.coverUrl,title:a.name,"card-data":a},{"customize-btn":t(()=>[g("span",{onClick:S=>A(a),style:{color:"green"},class:"customize-btn iconbl bl-a-fileedit-line"},null,8,re),g("span",{onClick:S=>I(a),style:{color:"red"},class:"customize-btn iconbl bl-delete-line"},null,8,te)]),_:2},1032,["image","title","card-data"]))),128))]),o(M,{style:{padding:"30px",height:"600px",overflow:"scroll"},title:"管理网址",modelValue:u.value,"onUpdate:modelValue":r[6]||(r[6]=a=>u.value=a),width:"600px",onClose:f},{default:t(()=>[o(D,{ref_key:"anchorFormRef",ref:y,model:e,"label-width":"auto",rules:F},{default:t(()=>[o(Z,{size:150,"image-url":e.coverUrl,onSelectFile:q},null,8,["image-url"]),o(n,{label:"封面：",prop:"cover"},{default:t(()=>[o(s,{modelValue:e.cover,"onUpdate:modelValue":r[0]||(r[0]=a=>e.cover=a),placeholder:"请输入封面URL"},null,8,["modelValue"])]),_:1}),o(n,{label:"名称：",prop:"name"},{default:t(()=>[o(s,{modelValue:e.name,"onUpdate:modelValue":r[1]||(r[1]=a=>e.name=a),placeholder:"请输入网址名称"},null,8,["modelValue"])]),_:1}),o(n,{label:"描述：",prop:"remark"},{default:t(()=>[o(s,{type:"textarea",rows:2,modelValue:e.remark,"onUpdate:modelValue":r[2]||(r[2]=a=>e.remark=a),placeholder:"请输入网址描述"},null,8,["modelValue"])]),_:1}),o(n,{label:"网址：",prop:"url"},{default:t(()=>[o(s,{modelValue:e.url,"onUpdate:modelValue":r[3]||(r[3]=a=>e.url=a),placeholder:"请输入网址URL"},null,8,["modelValue"])]),_:1}),o(n,{label:"分组：",prop:"groupType"},{default:t(()=>[o(z,{modelValue:e.groupType,"onUpdate:modelValue":r[4]||(r[4]=a=>e.groupType=a),filterable:"",placeholder:"请选择分组",style:{width:"200px"}},{default:t(()=>[(m(!0),v(_,null,w(b.value,a=>(m(),E(h,{key:a.value,label:a.name,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(n,{style:{"flex-direction":"column"}},{default:t(()=>[o(C,{onClick:f},{default:t(()=>[L("取消")]),_:1}),o(C,{type:"primary",onClick:r[5]||(r[5]=a=>R(y.value))},{default:t(()=>[L("确定")]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])],64)}}}),xe=ae(ne,[["__scopeId","data-v-ec66e98c"]]);export{xe as default};
