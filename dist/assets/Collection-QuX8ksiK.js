import{d as A,j as R,E as h,f as $,g as q,h as G,i as L}from"./element-plus-COxNbMku.js";import{l as S,e as j,f as H}from"./resources-hhhSbL7F.js";import{G as y}from"./GWTitleImageCard-BY1YM4Ws.js";import{I as J}from"./ImageUpload-TU36GBCe.js";import{d as O,r as m,b as P,H as k,c as x,a as _,L as l,M as w,a7 as Q,P as n,o as g,Q as W,T as V}from"./@vue-BV9Q_yhH.js";import{_ as K}from"./index-B-zCPnDV.js";import"./lodash-es-BDpUAi6D.js";import"./async-validator-DKvM95Vc.js";import"./@vueuse-DVUPgnhb.js";import"./dayjs-Didlxlvp.js";import"./@element-plus-DgtNr1CL.js";import"./@ctrl-D_sRHO8g.js";import"./@popperjs-D9SI2xQl.js";import"./request_website-Co468qfb.js";import"./axios-Cm0UX6qg.js";import"./pinia-CWZPuNdE.js";import"./vue-router-DaOdIdNP.js";import"./vue-pdf-embed-BcRweBTn.js";const X={class:"graython-Collection-root"},Y=["onClick"],Z=["onClick"],ee=O({__name:"Collection",setup(te){const r=m(!0),C=m(),b=m();P(()=>{u()});const u=async()=>{await S().then(e=>{b.value=e.data})},s=m(!1),t=k({name:""});let v;const F=k({name:[{required:!0,message:"请输入合集名称",trigger:"blur"}]}),c=e=>{e?(t.id=e.id,t.name=e.name,t.thumbnailUrl=e.thumbnailUrl):(t.id=void 0,t.name="",t.thumbnailUrl=void 0)},B=()=>{c(),s.value=!0},E=e=>{c(e),s.value=!0};function U(e){R.confirm("确定要删除合集["+e.name+"]吗？","确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{await j(e.id).then(()=>{u()}),h({type:"success",message:"删除成功!"})}).catch(()=>{h({type:"info",message:"取消删除"})})}const d=()=>{s.value=!1},I=async e=>{r.value&&e&&await e.validate(async(o,p)=>{if(o){r.value=!1;let i=new FormData;i.append("file",v),i.append("entity",JSON.stringify({id:t.id,name:t.name})),await H(i).then(f=>{r.value=!0,c(),d(),u()}).finally(()=>{r.value=!0})}else console.log("error submit!",p)})},T=e=>{v=e};return(e,o)=>{const p=$,i=q,f=G,D=L,M=A;return g(),x(w,null,[_("div",X,[l(y,{blankCard:!0,onClick:B}),(g(!0),x(w,null,Q(b.value,(a,N)=>(g(),W(y,{blankCard:!1,key:N,image:a.thumbnailUrl,title:a.name,"card-data":a},{"customize-btn":n(()=>[_("span",{onClick:z=>E(a),style:{color:"green"},class:"customize-btn iconbl bl-a-fileedit-line"},null,8,Y),_("span",{onClick:z=>U(a),style:{color:"red"},class:"customize-btn iconbl bl-delete-line"},null,8,Z)]),_:2},1032,["image","title","card-data"]))),128))]),l(M,{style:{padding:"30px","max-height":"500px",overflow:"scroll"},title:"管理合集",modelValue:s.value,"onUpdate:modelValue":o[2]||(o[2]=a=>s.value=a),width:"500px",onClose:d},{default:n(()=>[l(D,{ref_key:"collectionFormRef",ref:C,model:t,"label-width":"auto",rules:F},{default:n(()=>[l(J,{"image-url":t.thumbnailUrl,onSelectFile:T},null,8,["image-url"]),l(i,{label:"合集名称：",prop:"name"},{default:n(()=>[l(p,{modelValue:t.name,"onUpdate:modelValue":o[0]||(o[0]=a=>t.name=a),placeholder:"请输入合集名称"},null,8,["modelValue"])]),_:1}),l(i,{style:{"flex-direction":"column"}},{default:n(()=>[l(f,{onClick:d},{default:n(()=>[V("取消")]),_:1}),l(f,{type:"primary",onClick:o[1]||(o[1]=a=>I(C.value))},{default:n(()=>[V("确定")]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])],64)}}}),he=K(ee,[["__scopeId","data-v-e9ba0070"]]);export{he as default};
