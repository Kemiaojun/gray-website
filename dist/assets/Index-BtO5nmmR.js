import{_ as D,g as P,r as fe,t as Re}from"./index-iWPkJKS9.js";import"./request_website-6kSdq8YO.js";import{t as Te,_ as Ce}from"./Header.vue_vue_type_style_index_0_lang-DDhMg9nm.js";import{b as H,E as de,c as Le}from"./element-plus-ADHjtvoW.js";import{e as Se}from"./@vueuse-B6XrmGC7.js";import{e as g}from"./mitt-CJohXFwE.js";import{d as R,o as l,c as y,L as k,P as M,u as v,V as z,r as n,Q as $,a as s,S as $e,$ as Ie,I as Ee,b as Q,as as ve,at as _e,h as Be,G as Pe,Z as me,_ as pe,U as A,M as Ae,w as De,ah as He,R as ze,av as Fe}from"./@vue-D7aQumW7.js";import{s as w}from"./screenfull-DmVOzVZz.js";import{r as Ne}from"./music-TE7wXr8M.js";import"./pinia-BDK7V1n_.js";import"./axios-Cm0UX6qg.js";import"./vue-router-Dqk3Pi-3.js";import"./vue-pdf-embed-Cq-z5WX6.js";import"./lodash-es-BDpUAi6D.js";import"./async-validator-DKvM95Vc.js";import"./dayjs-Dc0JWrkO.js";import"./@element-plus-ZqzyRZ21.js";import"./@ctrl-D_sRHO8g.js";import"./@popperjs-D9SI2xQl.js";import"./auth-B9Odok5d.js";import"./mitt-DJ65BbbF.js";const Ue={key:0,class:"iconfont icon-sun"},Xe={key:1,class:"iconfont icon-moon"},je=R({__name:"index",setup(_){let c=Se();const i=()=>{c.value=!c.value,g.emit("dayNightChanged",c.value)};return(r,u)=>{const f=H;return l(),y("div",{style:{"margin-bottom":"1rem"},onClick:i},[k(f,{effect:"light",content:"日夜切换",placement:"left"},{default:M(()=>[v(c)?(l(),y("span",Ue)):(l(),y("span",Xe))]),_:1})])}}}),Ve={key:0,class:"iconfont icon-a-ScreenShrink"},We={key:1,class:"iconfont icon-a-ScreenExpand"},Ye=R({__name:"index",setup(_){function c(){w.isEnabled?w.isFullscreen?(de.success("退出网页全屏"),w.exit()):(de.success("进入网页全屏"),w.toggle()):Le.alert("浏览器不支持全屏","提示",{confirmButtonText:"确定",type:"warning"})}return(i,r)=>{const u=H;return v(w).isEnabled?(l(),y("div",{key:0,style:{"margin-bottom":"1rem"},onClick:r[0]||(r[0]=f=>c())},[k(u,{effect:"light",content:"全屏切换",placement:"left"},{default:M(()=>[v(w).isFullscreen?(l(),y("span",Ve)):(l(),y("span",We))]),_:1})])):z("",!0)}}}),qe=D(Ye,[["__scopeId","data-v-267e6f9e"]]),Ge=R({__name:"index",props:{fontSize:{type:String,default:"3rem"}},setup(_){const c=n(0);window.addEventListener("scroll",Te(()=>{c.value=window.scrollY||document.documentElement.scrollTop||document.body.scrollTop||0},100));function i(){window.scrollTo({top:0,behavior:"smooth"})}return(r,u)=>{const f=H;return l(),$(Ie,{name:"el-zoom-in-bottom"},{default:M(()=>[v(c)>=800?(l(),y("div",{key:0,style:{"margin-top":"1rem"},onClick:i},[k(f,{effect:"light",content:"回到顶部",placement:"left"},{default:M(()=>[s("span",{style:$e({fontSize:_.fontSize}),class:"iconfont icon-caps-unlock-filling"},null,4)]),_:1})])):z("",!0)]),_:1})}}}),Ke=_=>(ve("data-v-3a2f21cc"),_=_(),_e(),_),Oe={class:"toolbox_div"},Qe=Ke(()=>s("span",{id:"menu-icon",class:"iconfont icon-menu"},null,-1)),Ze={class:"mb-4"},Je=R({__name:"index",props:{toTop:{type:Boolean,default:!1}},emits:["ReadingMode"],setup(_,{emit:c}){const i=n(),r=_,{toTop:u}=Ee(r),f=n(!1),h=()=>{T(),f.value?(f.value=!1,i.value.classList.add("hide")):(f.value=!0,i.value.classList.remove("hide"))},T=()=>{const o=document.getElementById("menu-icon");o==null||o.classList.add("active"),setTimeout(function(){o==null||o.classList.remove("active")},1e3)};return Q(()=>{console.log(u.value)}),(o,C)=>{const d=H;return l(),y("div",Oe,[s("div",{ref_key:"moreRef",ref:i,class:"hide"},[k(je),k(qe)],512),s("div",{class:"rotate-box",onClick:h},[k(d,{effect:"light",content:"更多功能",placement:"left"},{default:M(()=>[Qe]),_:1})]),s("div",Ze,[v(u)?(l(),$(Ge,{key:0})):z("",!0)])])}}}),et=D(Je,[["__scopeId","data-v-3a2f21cc"]]),ye=_=>(ve("data-v-22eff958"),_=_(),_e(),_),tt={class:"music-player-top"},st={class:"music-player"},nt={class:"top-bar"},ot=ye(()=>s("span",{class:"iconfont icon-24gl-volumeMiddle"},null,-1)),it=["src"],at={class:"lyric-wrapper"},lt={class:"info-right"},ct={class:"music-name"},rt={class:"playback-setting"},ut=ye(()=>s("span",{class:"duration-bar play-duration"},null,-1)),ft={class:"music-disc"},dt=["src"],mt={class:"info-box"},pt={class:"info"},vt={class:"text-sm whitespace-nowrap"},_t={class:"text-sm whitespace-nowrap"},yt=R({__name:"index",setup(_){const c=n(!1),i=n({id:"",name:"",src:"",img:"/favicon.png",artist:"",lyrics:""}),r=n([]),u=n(!1),f=n(),h=n(!1),T=/^\[(\d{1}):(\d{2})\.(\d+)$/,o=/^\[(\d{2}):(\d{2})\.(\d+)$/,C=/^\[(\d{1}):(\d{2}):(\d{2})$/,d=n(),F=n(),Z=n(),J=n(),L=n(),N=n(),U=n(),X=n(),j=n(),ee=n(),V=n(),ge=n(),W=n(),Y=n(!0);Be(()=>"/favicon.png");let q,te,b=0;function he(){q&&clearInterval(q),te=d.value.duration,q=setInterval(function(){se()},1e3)}function se(){if(u.value&&j.value){j.value.style.width=d.value.currentTime/d.value.duration*100+"%";let e=d.value.duration-d.value.currentTime,t=parseInt(String(e/60)),m=parseInt(String(e%60)),a=`${t<10?"0"+t:t}:${m<10?"0"+m:m}`;ee.value.innerHTML=a,ne()}}let x=[],I=[];function ne(){if(h.value){let e=K(x,Math.floor(d.value.currentTime));e<0&&(e=0),L.value.style.top=e*-21+150+"px",[...L.value.children].forEach(t=>{t.style.color="var(--gw-bg-font)"}),L.value.children[e].style.color="aqua"}}function oe(){let e="";x=[],I=[];let t=i==null?void 0:i.value.lyrics;if(!t)e+="<li>未发现歌词</li>",x=[0];else try{t.split(`
`).forEach(a=>{const p=a.split("]");T.test(p[0])?x.push(G(p[0].substr(1,5))):o.test(p[0])?x.push(G(p[0].substr(1,6))):C.test(p[0])&&x.push(G(p[0].substr(4,p[0].length))),I.push(p[1]),e+=`<li>${I[I.length-1]}</li>`})}catch{e+="<li>歌词格式不正确</li>",x=[0]}u.value&&(L.value.innerHTML=e)}function G(e){if(e){const t=e.split(":"),m=t[0],a=t[1];return parseInt(m)*60+parseInt(a)}}function E(e){if(r.value.length>0){let t=r.value[e];i.value=t,d.value.src=t.src,g.emit("musicChanged",i.value),Y.value=!0,u.value&&(J.value.innerHTML=t.artist,Z.value.innerHTML=t.title,h.value&&oe())}}function S(){d.value.play(),c.value=!0}function ie(){d.value.pause(),c.value=!1}function ae(){b==0?b=r.value.length-1:b--,E(b),S()}function B(){b==r.value.length-1?b=0:b++,E(b),S()}function K(e,t,m=0,a=e.length-1){if(m>a)return m-1;const p=Math.floor((m+a)/2);return e[p]===t?p:e[p]>t?K(e,t,m,p-1):K(e,t,p+1,a)}function ke(){Y.value&&(oe(),Y.value=!1),h.value?(N.value.style.display="flex",X.value.style.display="none",U.value.style.width="40%",h.value=!1):(N.value.style.display="block",X.value.style.display="block",U.value.style.width="100%",h.value=!0)}function be(e){d.value.currentTime=e.offsetX/e.target.offsetWidth*te,se()}function xe(e){d.value.volume=e.offsetX/e.target.offsetWidth,V.value.style.width=e.offsetX/e.target.offsetWidth*100+"%"}function we(){let e=W.value.offsetWidth;document.onmousemove=function(t){let a=(t||event).clientX-W.value.getBoundingClientRect().left;a>e?a=e:a==0&&(a=0),V.value.style.width=a/e*100+"%",d.value.volume=a/e},document.onmouseup=function(){document.onmousemove=null,document.onmouseup=null}}const O=n(!1);let le=0,ce=0;const Me=e=>{if(O.value=!0,f.value){let t=f.value.getBoundingClientRect();le=t.width,ce=t.height}document.addEventListener("mousemove",re),document.addEventListener("mouseup",ue)},re=e=>{O.value&&f.value&&(f.value.style.left=e.clientX+le/2-18+"px",f.value.style.top=e.clientY+ce/2-18.75+"px")},ue=()=>{O.value=!1,document.removeEventListener("mousemove",re),document.removeEventListener("mouseup",ue)};return Q(async()=>{await Ne(5).then(e=>{e.data&&(r.value=e.data.map(t=>({id:t.id,name:t.title,src:P()+t.previewUrl,img:t.artistThumbnail?P()+t.artistThumbnail:"/favicon.png",artist:t.artist,lyrics:t.lyrics})))}),E(0),g.on("playMusic",()=>{S()}),g.on("previousMusic",()=>{ae()}),g.on("nextMusic",()=>{B()}),g.on("setMusic",e=>{E(e)}),g.on("playSelectedMusic",e=>{r.value.unshift(...e.map(t=>({id:t.id,name:t.title,src:P()+t.previewUrl.replace("//","/"),img:t.artistThumbnail?P()+t.artistThumbnail:"/favicon.png",artist:t.artist,lyrics:t.lyrics})))})}),Pe(()=>{g.off("playMusic"),g.off("previousMusic"),g.off("nextMusic"),g.off("setMusic"),g.off("playSelectedMusic")}),(e,t)=>{var m,a;return l(),y(Ae,null,[me(s("div",{ref_key:"musicPlayerRef",ref:f,class:"music-player-wrapper"},[s("div",tt,[s("span",{onMousedown:Me,class:"iconfont icon-hand"},null,32),s("span",{onClick:t[0]||(t[0]=p=>u.value=!1),class:"iconfont icon--"})]),s("div",st,[s("div",nt,[ot,s("div",{ref_key:"soundProgressBarRef",ref:W,class:"progress-bar sound-progress-bar"},[s("span",{onClick:xe,class:"duration-bar sound-duration"}),s("span",{ref_key:"soundProgressRef",ref:V,class:"progress sound-progress"},[s("span",{onMousedown:we,ref_key:"roundRef",ref:ge,class:"round"},null,544)],512)],512),s("span",{class:"iconfont icon-geciweidianji",onClick:ke})]),s("div",{ref_key:"musicInfoRef",ref:N,class:"music-info"},[s("div",{ref_key:"infoLeftRef",ref:U,class:"info-left"},[s("img",{ref_key:"musicImgRef",ref:F,class:"music-img",alt:"",src:v(i).img},null,8,it),s("div",{ref_key:"lyricMaskRef",ref:X,class:"lyric-mask"},[s("div",at,[s("ul",{ref_key:"lyricContentRef",ref:L,id:"lyc-content",style:{top:"100px"}},null,512)])],512)],512),s("div",lt,[s("div",ct,[s("span",{ref_key:"musicNameRef",ref:Z,class:"name"},A(v(i).name||"放首歌听听吧"),513),s("span",{ref_key:"musicAuthorRef",ref:J,class:"musician"},A(v(i).artist||""),513)]),s("div",rt,[s("span",{onClick:ae,class:"iconfont icon-next previous"}),v(c)?(l(),y("span",{key:0,onClick:ie,class:"iconfont icon-zanting1"})):(l(),y("span",{key:1,onClick:S,class:"iconfont icon-bofang"})),s("span",{onClick:B,class:"iconfont icon-next next"})])])],512),s("div",{onClick:be,class:"progress-bar player-progress-bar"},[ut,s("span",{ref_key:"playerProgressRef",ref:j,class:"progress player-progress"},null,512),s("span",{ref_key:"musicTimeRef",ref:ee,class:"time"},"00:00",512)])])],512),[[pe,v(u)]]),me(s("div",ft,[s("img",{onClick:t[1]||(t[1]=p=>u.value=!v(u)),class:"music-img",src:v(i).img,alt:"musician logo"},null,8,dt),s("div",mt,[s("div",pt,[s("div",vt,A(((m=v(i))==null?void 0:m.name)||"放首歌来听吧"),1),s("div",_t,A((a=v(i))==null?void 0:a.artist),1)]),s("span",{onClick:B,style:{"margin-right":"1rem"},class:"iconfont icon-next"}),v(c)?(l(),y("span",{key:0,onClick:ie,class:"iconfont icon-zanting1"})):(l(),y("span",{key:1,onClick:S,class:"iconfont icon-bofang"}))])],512),[[pe,!v(u)]]),s("audio",{src:"",ref_key:"audioRef",ref:d,onTimeupdate:ne,onCanplay:he,onEnded:B},null,544)],64)}}}),gt=D(yt,[["__scopeId","data-v-22eff958"]]),ht={id:"index-layout",class:"layout-root-container"},kt=R({__name:"Index",setup(_){const c=n([{icon:"icon-wangzhanshouye",name:"Home",title:"首页"},{icon:"icon-Bloggericon",name:"Articles",title:"博文"},{icon:"icon-wangzhantubiao",name:"Links",title:"导航"},{icon:"icon-heji",name:"Resource",title:"资源"},{icon:"icon-dianying",name:"Movie",title:"影院"},{icon:"icon-18erji-2",name:"Music",title:"音乐"}]),i=n("Home"),r=n(["Home"]),u=n("Home");Q(async()=>{}),De(()=>fe.currentRoute.value,o=>{o.name&&(u.value=o.name,i.value=o.name.toString()),o.meta.keepAlive&&r.value.indexOf(o.name)===-1&&r.value.push(o.name)},{immediate:!0});const f=["Login"],h=()=>{const o=fe.currentRoute.value;return!(o!=null&&o.name&&f.find(C=>C===o.name))},T=o=>{i.value=o,Re(o)};return(o,C)=>{const d=He("router-view");return l(),y("div",ht,[h()?(l(),$(Ce,{key:0,tabs:c.value,selectedTab:i.value,"onUpdate:selectedTab":T},null,8,["tabs","selectedTab"])):z("",!0),k(d,null,{default:M(({Component:F})=>[(l(),$(Fe,{include:[r.value]},[(l(),$(ze(F)))],1032,["include"]))]),_:1}),k(et,{toTop:!0}),k(gt)])}}}),Xt=D(kt,[["__scopeId","data-v-002e6833"]]);export{Xt as default};
