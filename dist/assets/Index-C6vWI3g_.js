import{_ as D,g as ue,r as fe,t as Te}from"./index-BSrPZ2yy.js";import"./request_website-BFItCA4C.js";import{t as Ce,_ as Ie}from"./Header.vue_vue_type_style_index_0_lang-Bt9ekw6B.js";import{b as H,E as de,c as Le}from"./element-plus-D_LIGSL8.js";import{e as Se}from"./@vueuse-DVUPgnhb.js";import{e as g}from"./mitt-CJohXFwE.js";import{d as C,o as r,c as y,L as x,P as T,u as d,V as z,r as n,Q as $,a as t,S as $e,$ as Ee,I as Pe,b as O,at as ve,au as _e,h as Be,G as Ae,Z as me,_ as pe,U as A,M as De,g as He,w as ze,ah as Fe,R as Ne,av as Xe}from"./@vue-BV9Q_yhH.js";import{s as R}from"./screenfull-DmVOzVZz.js";/* empty css                             */import"./pinia-CWZPuNdE.js";import"./axios-Cm0UX6qg.js";import"./vue-router-DaOdIdNP.js";import"./vue-pdf-embed-BcRweBTn.js";import"./lodash-es-BDpUAi6D.js";import"./async-validator-DKvM95Vc.js";import"./dayjs-Dc0JWrkO.js";import"./@element-plus-DgtNr1CL.js";import"./@ctrl-D_sRHO8g.js";import"./@popperjs-D9SI2xQl.js";import"./auth-DA9xbFhW.js";import"./mitt-DJ65BbbF.js";const je={key:0,class:"iconfont icon-sun"},Ue={key:1,class:"iconfont icon-moon"},Ve=C({__name:"index",setup(m){let v=Se();const u=()=>{v.value=!v.value,g.emit("dayNightChanged",v.value)};return(a,_)=>{const l=H;return r(),y("div",{style:{"margin-bottom":"1rem"},onClick:u},[x(l,{effect:"light",content:"日夜切换",placement:"left"},{default:T(()=>[d(v)?(r(),y("span",je)):(r(),y("span",Ue))]),_:1})])}}}),We={key:0,class:"iconfont icon-a-ScreenShrink"},Ye={key:1,class:"iconfont icon-a-ScreenExpand"},qe=C({__name:"index",setup(m){function v(){R.isEnabled?R.isFullscreen?(de.success("退出网页全屏"),R.exit()):(de.success("进入网页全屏"),R.toggle()):Le.alert("浏览器不支持全屏","提示",{confirmButtonText:"确定",type:"warning"})}return(u,a)=>{const _=H;return d(R).isEnabled?(r(),y("div",{key:0,style:{"margin-bottom":"1rem"},onClick:a[0]||(a[0]=l=>v())},[x(_,{effect:"light",content:"全屏切换",placement:"left"},{default:T(()=>[d(R).isFullscreen?(r(),y("span",We)):(r(),y("span",Ye))]),_:1})])):z("",!0)}}}),Ge=D(qe,[["__scopeId","data-v-267e6f9e"]]),Ke=C({__name:"index",props:{fontSize:{type:String,default:"3rem"}},setup(m){const v=n(0);window.addEventListener("scroll",Ce(()=>{v.value=window.scrollY||document.documentElement.scrollTop||document.body.scrollTop||0},100));function u(){window.scrollTo({top:0,behavior:"smooth"})}return(a,_)=>{const l=H;return r(),$(Ee,{name:"el-zoom-in-bottom"},{default:T(()=>[d(v)>=800?(r(),y("div",{key:0,style:{"margin-top":"1rem"},onClick:u},[x(l,{effect:"light",content:"回到顶部",placement:"left"},{default:T(()=>[t("span",{style:$e({fontSize:m.fontSize}),class:"iconfont icon-caps-unlock-filling"},null,4)]),_:1})])):z("",!0)]),_:1})}}}),Oe=m=>(ve("data-v-3a2f21cc"),m=m(),_e(),m),Qe={class:"toolbox_div"},Ze=Oe(()=>t("span",{id:"menu-icon",class:"iconfont icon-menu"},null,-1)),Je={class:"mb-4"},et=C({__name:"index",props:{toTop:{type:Boolean,default:!1}},emits:["ReadingMode"],setup(m,{emit:v}){const u=n(),a=m,{toTop:_}=Pe(a),l=n(!1),h=()=>{k(),l.value?(l.value=!1,u.value.classList.add("hide")):(l.value=!0,u.value.classList.remove("hide"))},k=()=>{const o=document.getElementById("menu-icon");o==null||o.classList.add("active"),setTimeout(function(){o==null||o.classList.remove("active")},1e3)};return O(()=>{console.log(_.value)}),(o,I)=>{const L=H;return r(),y("div",Qe,[t("div",{ref_key:"moreRef",ref:u,class:"hide"},[x(Ve),x(Ge)],512),t("div",{class:"rotate-box",onClick:h},[x(L,{effect:"light",content:"更多功能",placement:"left"},{default:T(()=>[Ze]),_:1})]),t("div",Je,[d(_)?(r(),$(Ke,{key:0})):z("",!0)])])}}}),tt=D(et,[["__scopeId","data-v-3a2f21cc"]]),ye=m=>(ve("data-v-905c05ca"),m=m(),_e(),m),st={class:"music-player-top"},nt={class:"music-player"},ot={class:"top-bar"},it=ye(()=>t("span",{class:"iconfont icon-24gl-volumeMiddle"},null,-1)),at=["src"],lt={class:"lyric-wrapper"},ct={class:"info-right"},rt={class:"music-name"},ut={class:"playback-setting"},ft=ye(()=>t("span",{class:"duration-bar play-duration"},null,-1)),dt={class:"music-disc"},mt=["src"],pt={class:"info-box"},vt={class:"info"},_t={class:"text-sm whitespace-nowrap"},yt={class:"text-sm whitespace-nowrap"},gt=C({__name:"index",setup(m,{expose:v}){const u=n(!1),a=n({id:"",name:"",src:"",img:"/favicon.png",artist:"",lyrics:""}),_=n([]),l=n(!1),h=n(),k=n(!1),o=/^\[(\d{1}):(\d{2})\.(\d+)$/,I=/^\[(\d{2}):(\d{2})\.(\d+)$/,L=/^\[(\d{1}):(\d{2}):(\d{2})$/,p=n(),ge=n(),Q=n(),Z=n(),S=n(),F=n(),N=n(),X=n(),j=n(),J=n(),U=n(),he=n(),V=n(),W=n(!0);Be(()=>"/favicon.png");let Y,ee,b=0;function ke(){Y&&clearInterval(Y),ee=p.value.duration,Y=setInterval(function(){te()},1e3)}function te(){if(l.value&&j.value){j.value.style.width=p.value.currentTime/p.value.duration*100+"%";let e=p.value.duration-p.value.currentTime,s=parseInt(String(e/60)),i=parseInt(String(e%60)),c=`${s<10?"0"+s:s}:${i<10?"0"+i:i}`;J.value.innerHTML=c,se()}}let w=[],E=[];function se(){if(k.value){let e=G(w,Math.floor(p.value.currentTime));e<0&&(e=0),S.value.style.top=e*-21+150+"px",[...S.value.children].forEach(s=>{s.style.color="var(--gw-bg-font)"}),S.value.children[e].style.color="aqua"}}function ne(){let e="";w=[],E=[];let s=a==null?void 0:a.value.lyrics;if(!s)e+="<li>未发现歌词</li>",w=[0];else try{s.split(`
`).forEach(c=>{const f=c.split("]");o.test(f[0])?w.push(q(f[0].substr(1,5))):I.test(f[0])?w.push(q(f[0].substr(1,6))):L.test(f[0])&&w.push(q(f[0].substr(4,f[0].length))),E.push(f[1]),e+=`<li>${E[E.length-1]}</li>`})}catch{e+="<li>歌词格式不正确</li>",w=[0]}l.value&&(S.value.innerHTML=e)}function q(e){if(e){const s=e.split(":"),i=s[0],c=s[1];return parseInt(i)*60+parseInt(c)}}function P(e){if(_.value.length>0){let s=_.value[e];a.value=s,p.value.src=s.src,g.emit("musicChanged",a.value),W.value=!0,l.value&&(Z.value.innerHTML=s.artist,Q.value.innerHTML=s.title,k.value&&ne())}}function M(){p.value.play(),u.value=!0}function oe(){p.value.pause(),u.value=!1}function ie(){b==0?b=_.value.length-1:b--,P(b),M()}function B(){b==_.value.length-1?b=0:b++,P(b),M()}function G(e,s,i=0,c=e.length-1){if(i>c)return i-1;const f=Math.floor((i+c)/2);return e[f]===s?f:e[f]>s?G(e,s,i,f-1):G(e,s,f+1,c)}function xe(){W.value&&(ne(),W.value=!1),k.value?(F.value.style.display="flex",X.value.style.display="none",N.value.style.width="40%",k.value=!1):(F.value.style.display="block",X.value.style.display="block",N.value.style.width="100%",k.value=!0)}function be(e){p.value.currentTime=e.offsetX/e.target.offsetWidth*ee,te()}function we(e){p.value.volume=e.offsetX/e.target.offsetWidth,U.value.style.width=e.offsetX/e.target.offsetWidth*100+"%"}function Me(){let e=V.value.offsetWidth;document.onmousemove=function(s){let c=(s||event).clientX-V.value.getBoundingClientRect().left;c>e?c=e:c==0&&(c=0),U.value.style.width=c/e*100+"%",p.value.volume=c/e},document.onmouseup=function(){document.onmousemove=null,document.onmouseup=null}}const K=n(!1);let ae=0,le=0;const Re=e=>{if(K.value=!0,h.value){let s=h.value.getBoundingClientRect();ae=s.width,le=s.height}document.addEventListener("mousemove",ce),document.addEventListener("mouseup",re)},ce=e=>{K.value&&h.value&&(h.value.style.left=e.clientX+ae/2-18+"px",h.value.style.top=e.clientY+le/2-18.75+"px")},re=()=>{K.value=!1,document.removeEventListener("mousemove",ce),document.removeEventListener("mouseup",re)};return O(()=>{const e=He();e&&(window._MusicPlayer=e.proxy),P(0),g.on("playMusic",()=>{M()}),g.on("previousMusic",()=>{ie()}),g.on("nextMusic",()=>{B()}),g.on("setMusic",s=>{P(s)}),g.on("playSelectedMusic",s=>{_.value.unshift(...s.map(i=>({id:i.id,name:i.title,src:ue()+i.previewUrl.replace("//","/"),img:i.artistThumbnail?ue()+i.artistThumbnail:"/favicon.png",artist:i.artist,lyrics:i.lyrics})))})}),Ae(()=>{delete window._MusicPlayer,g.off("playMusic"),g.off("previousMusic"),g.off("nextMusic"),g.off("setMusic"),g.off("playSelectedMusic")}),v({playMusic:M}),(e,s)=>{var i,c;return r(),y(De,null,[me(t("div",{ref_key:"musicPlayerRef",ref:h,class:"music-player-wrapper"},[t("div",st,[t("span",{onMousedown:Re,class:"iconfont icon-hand"},null,32),t("span",{onClick:s[0]||(s[0]=f=>l.value=!1),class:"iconfont icon--"})]),t("div",nt,[t("div",ot,[it,t("div",{ref_key:"soundProgressBarRef",ref:V,class:"progress-bar sound-progress-bar"},[t("span",{onClick:we,class:"duration-bar sound-duration"}),t("span",{ref_key:"soundProgressRef",ref:U,class:"progress sound-progress"},[t("span",{onMousedown:Me,ref_key:"roundRef",ref:he,class:"round"},null,544)],512)],512),t("span",{class:"iconfont icon-geciweidianji",onClick:xe})]),t("div",{ref_key:"musicInfoRef",ref:F,class:"music-info"},[t("div",{ref_key:"infoLeftRef",ref:N,class:"info-left"},[t("img",{ref_key:"musicImgRef",ref:ge,class:"music-img",alt:"",src:d(a).img},null,8,at),t("div",{ref_key:"lyricMaskRef",ref:X,class:"lyric-mask"},[t("div",lt,[t("ul",{ref_key:"lyricContentRef",ref:S,id:"lyc-content",style:{top:"100px"}},null,512)])],512)],512),t("div",ct,[t("div",rt,[t("span",{ref_key:"musicNameRef",ref:Q,class:"name"},A(d(a).name||"放首歌听听吧"),513),t("span",{ref_key:"musicAuthorRef",ref:Z,class:"musician"},A(d(a).artist||""),513)]),t("div",ut,[t("span",{onClick:ie,class:"iconfont icon-next previous"}),d(u)?(r(),y("span",{key:0,onClick:oe,class:"iconfont icon-zanting1"})):(r(),y("span",{key:1,onClick:M,class:"iconfont icon-bofang"})),t("span",{onClick:B,class:"iconfont icon-next next"})])])],512),t("div",{onClick:be,class:"progress-bar player-progress-bar"},[ft,t("span",{ref_key:"playerProgressRef",ref:j,class:"progress player-progress"},null,512),t("span",{ref_key:"musicTimeRef",ref:J,class:"time"},"00:00",512)])])],512),[[pe,d(l)]]),me(t("div",dt,[t("img",{onClick:s[1]||(s[1]=f=>l.value=!d(l)),class:"music-img",src:d(a).img,alt:"musician logo"},null,8,mt),t("div",pt,[t("div",vt,[t("div",_t,A(((i=d(a))==null?void 0:i.name)||"放首歌来听吧"),1),t("div",yt,A((c=d(a))==null?void 0:c.artist),1)]),t("span",{onClick:B,style:{"margin-right":"1rem"},class:"iconfont icon-next"}),d(u)?(r(),y("span",{key:0,onClick:oe,class:"iconfont icon-zanting1"})):(r(),y("span",{key:1,onClick:M,class:"iconfont icon-bofang"}))])],512),[[pe,!d(l)]]),t("audio",{src:"",ref_key:"audioRef",ref:p,onTimeupdate:se,onCanplay:ke,onEnded:B},null,544)],64)}}}),ht=D(gt,[["__scopeId","data-v-905c05ca"]]),kt={id:"index-layout",class:"layout-root-container"},xt=C({__name:"Index",setup(m){const v=n([{icon:"icon-wangzhanshouye",name:"Home",title:"首页"},{icon:"icon-Bloggericon",name:"Articles",title:"博文"},{icon:"icon-wangzhantubiao",name:"Links",title:"导航"},{icon:"icon-heji",name:"Resource",title:"资源"},{icon:"icon-dianying",name:"Movie",title:"影院"},{icon:"icon-18erji-2",name:"Music",title:"音乐"}]),u=n("Home"),a=n(["Home"]),_=n("Home");O(async()=>{}),ze(()=>fe.currentRoute.value,o=>{o.name&&(_.value=o.name,u.value=o.name.toString()),o.meta.keepAlive&&a.value.indexOf(o.name)===-1&&a.value.push(o.name)},{immediate:!0});const l=["Login"],h=()=>{const o=fe.currentRoute.value;return!(o!=null&&o.name&&l.find(I=>I===o.name))},k=o=>{u.value=o,Te(o)};return(o,I)=>{const L=Fe("router-view");return r(),y("div",kt,[h()?(r(),$(Ie,{key:0,tabs:v.value,selectedTab:u.value,"onUpdate:selectedTab":k},null,8,["tabs","selectedTab"])):z("",!0),x(L,null,{default:T(({Component:p})=>[(r(),$(Xe,{include:[a.value]},[(r(),$(Ne(p)))],1032,["include"]))]),_:1}),x(tt,{toTop:!0}),x(ht)])}}}),Ut=D(xt,[["__scopeId","data-v-002e6833"]]);export{Ut as default};
