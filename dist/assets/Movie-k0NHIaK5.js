import{q as T,E as z,c as L,b as q}from"./element-plus-COxNbMku.js";import{_ as O}from"./GWPreviewVideo-3r3yz1Ux.js";import{_ as Q}from"./GWSearchCondition-DTMvVsha.js";import{u as j}from"./vue-router-DaOdIdNP.js";import{_ as F,b as M}from"./index-0LZCLISq.js";import{d as x}from"./request_website-D5xL74Et.js";import{c as d,D as H,o as l,d as I,I as J,a as i,u as w,U as K,ab as $,r as n,w as X,b as Y,L as y,P as b,Q as D,V as Z,M as A,a7 as E}from"./@vue-BV9Q_yhH.js";import"./lodash-es-BDpUAi6D.js";import"./async-validator-DKvM95Vc.js";import"./@vueuse-DVUPgnhb.js";import"./dayjs-Didlxlvp.js";import"./@element-plus-DgtNr1CL.js";import"./@ctrl-D_sRHO8g.js";import"./@popperjs-D9SI2xQl.js";import"./pinia-CWZPuNdE.js";import"./axios-Cm0UX6qg.js";import"./vue-pdf-embed-BcRweBTn.js";const ee=s=>{const e={headers:{"Content-Type":"multipart/form-data"}};return x.post("/movie/cover",s,e)},te=()=>x.get("/movie/refresh"),ae=()=>x.get("/movie/categories"),oe=s=>x.post("/movie/page",{...s}),ne={},se={class:"gw-flex-container"};function le(s,e){return l(),d("div",se,[H(s.$slots,"flex-items",{},void 0,!0)])}const ie=F(ne,[["render",le],["__scopeId","data-v-4688a806"]]),re={class:"gw-flex-item"},ce={class:"gw-flex-card"},ue=["src"],pe={class:"gw-flex-info"},me={class:"movie-title"},de=I({__name:"GWFlexImage",props:{title:{},src:{},itemData:{},play:{type:Function},click:{type:Function}},setup(s){const e=s,{src:c,title:_}=J(e);function f(){if(e!=null&&e.click){const a=e.itemData?$(e.itemData):{};e.click(a)}}function u(){if(e!=null&&e.play){const a=e.itemData?$(e.itemData):{};e.play(a)}}return(a,k)=>(l(),d("div",re,[i("div",ce,[i("img",{onclick:f,src:w(c),onerror:"this.onerror=null;this.src='/favicon.png';",alt:"Sorry, something went wrong"},null,8,ue),i("div",pe,[i("h3",me,K(w(_)),1),i("h3",{class:"movie-play",onclick:u},"Play")])])]))}}),_e=F(de,[["__scopeId","data-v-4f650451"]]),fe={class:"image-gallery"},ve={class:"search-item"},ge={style:{width:"100%"}},he=I({__name:"Movie",setup(s){j();const e=n(0),c=n(1),_=n(20),f=n(),u=n(!1),a=n(),k=n(),v=n(),N=t=>{a.value=t,R.value.click()},P=t=>{a.value=t,u.value=!0},U=t=>{c.value=t,C()},C=async()=>{await oe({pageNo:c.value,pageSize:_.value,folderName:v.value}).then(t=>{f.value=t.data.result,e.value=t.data.total})},R=n(),W=async t=>{if(a.value){const r=t.target;if(r.files&&r.files[0]){const g=new FileReader;g.onload=m=>{var h;(h=m.target)==null||h.result},g.readAsDataURL(r.files[0]);let p=new FormData;p.append("file",r.files[0]),p.append("id",a.value.id+""),await ee(p).then(m=>{debugger;m.data&&z({type:"info",message:"电影海报已更新，请刷新页面查看"})}).finally(()=>{})}}},B=()=>{u.value=!1};return X(()=>v.value,()=>{C()},{deep:!0,immediate:!0}),Y(async()=>{C(),await ae().then(t=>{k.value=t.data}),te()}),(t,r)=>{var S,V;const g=q,p=L,m=Q,h=O,G=T;return l(),d("div",fe,[y(m,null,{"search-items":b(()=>[i("div",ve,[y(p,{modelValue:v.value,"onUpdate:modelValue":r[0]||(r[0]=o=>v.value=o),clearable:"",placeholder:"分类",style:{width:"150px"}},{default:b(()=>[(l(!0),d(A,null,E(k.value,o=>(l(),D(g,{key:o,label:o,value:o},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),_:1}),y(ie,{style:{"min-height":"calc(100% - 100px)"}},{"flex-items":b(()=>[(l(!0),d(A,null,E(f.value,(o,ye)=>(l(),D(_e,{click:N,play:P,title:o.title,"item-data":o,src:w(M)()+o.coverUrl},null,8,["title","item-data","src"]))),256))]),_:1}),i("input",{ref_key:"fileselectRef",ref:R,style:{display:"none"},type:"file",accept:"image/*",onChange:W},null,544),u.value?(l(),D(h,{key:0,url:w(M)()+((S=a.value)==null?void 0:S.previewUrl),name:(V=a.value)==null?void 0:V.title,"on-close":B},null,8,["url","name"])):Z("",!0),i("div",ge,[y(G,{style:{"flex-direction":"row-reverse"},background:"",layout:"prev, pager, next",total:e.value,"pager-count":5,"page-size":_.value,"current-page":c.value,onCurrentChange:U},null,8,["total","page-size","current-page"])])])}}}),Ue=F(he,[["__scopeId","data-v-af002d7b"]]);export{Ue as default};
