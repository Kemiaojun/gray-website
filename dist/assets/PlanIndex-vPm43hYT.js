import{m as Y,f as q,g as Z,A as ee,B as le,C as te,D as ae,i as oe,h as N,t as ne,s as se,j as de,w as ie}from"./element-plus-COxNbMku.js";import{B as j}from"./@element-plus-DgtNr1CL.js";import{q as U,_ as H}from"./index-DxmBRgxG.js";import{g as re,a as ue}from"./util-DisF612g.js";import{d as L,r as c,H as pe,ah as A,o as D,c as x,a as s,L as e,P as a,u as G,S as J,T as _,M,a7 as K,J as O,at as Q,au as W,b as me,w as ce,U as V,V as _e}from"./@vue-BV9Q_yhH.js";import"./lodash-es-BDpUAi6D.js";import"./async-validator-DKvM95Vc.js";import"./@vueuse-DVUPgnhb.js";import"./dayjs-Didlxlvp.js";import"./@ctrl-D_sRHO8g.js";import"./@popperjs-D9SI2xQl.js";import"./pinia-CWZPuNdE.js";import"./axios-Cm0UX6qg.js";import"./vue-router-DaOdIdNP.js";import"./vue-pdf-embed-BcRweBTn.js";const ve=d=>U.get("/plan/list/day",{params:d}),fe=d=>U.post("/plan/add/day",d),ye=d=>U.post("/plan/del",d),be=d=>U.post("/plan/upd/day",d),R=d=>(Q("data-v-02b9098d"),d=d(),W(),d),ge={class:"day-info-root"},he={class:"info-form"},Ve=R(()=>s("div",{style:{"margin-right":"10px"}},"重复天数",-1)),De=R(()=>s("span",{class:"iconbl bl-a-colorpalette-line",style:{"font-size":"13px","padding-left":"5px"}},null,-1)),xe=["onClick"],we=R(()=>s("span",{class:"iconbl bl-a-templateadd-line",style:{"margin-right":"10px"}},null,-1)),ke=L({__name:"PlanDayInfo",emits:["saved"],setup(d,{emit:C}){const f=["purple","red","yellow","blue","green","gray"],y=c(),l=c({title:"",content:"",planDate:"",planStartTime:"",planEndTime:"",allDay:!1,repeat:!1,repeatDay:1,color:"purple"}),k=pe({planDate:[{required:!0,message:"请填写日期",trigger:"change"}],planStartTime:[{required:!0,message:"请填写开始时间",trigger:"change"}],planEndTime:[{required:!0,message:"请填写结束时间",trigger:"change"}],title:[{required:!0,message:"请填写计划标题",trigger:"change"}]}),b=r=>{r?(l.value.planStartTime="00:00",l.value.planEndTime="23:59"):(l.value.planStartTime="",l.value.planEndTime="")},z=r=>{r||(l.value.repeatDay=1)},h=r=>{l.value.color=r},$=async r=>{r&&await r.validate((t,E)=>{t&&fe(l.value).then(T=>{F("saved")})})},F=C;return(r,t)=>{const E=Y,T=q,m=Z,u=ee,n=le,p=te,S=ae,g=A("bl-row"),P=A("bl-col"),I=oe,B=N;return D(),x("div",ge,[s("div",he,[e(I,{ref_key:"DayFormRef",ref:y,model:l.value,rules:k,"label-position":"top","label-width":"60px",size:"small"},{default:a(()=>[e(m,{prop:"title"},{default:a(()=>[e(T,{modelValue:l.value.title,"onUpdate:modelValue":t[0]||(t[0]=o=>l.value.title=o),placeholder:"计划标题",style:{width:"calc(100% - 30px)"}},{prefix:a(()=>[e(E,{size:"15"},{default:a(()=>[e(G(j))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(m,null,{default:a(()=>[e(T,{type:"textarea",rows:5,modelValue:l.value.content,"onUpdate:modelValue":t[1]||(t[1]=o=>l.value.content=o),placeholder:"计划内容",resize:"none"},null,8,["modelValue"])]),_:1}),e(m,{label:"计划日期",prop:"planDate"},{default:a(()=>[e(u,{modelValue:l.value.planDate,"onUpdate:modelValue":t[2]||(t[2]=o=>l.value.planDate=o),type:"date",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD HH:mm:ss",style:{width:"100%"},editable:!1},null,8,["modelValue"])]),_:1}),e(m,{label:"开始时间 / 结束时间",required:""},{default:a(()=>[e(m,{prop:"planStartTime"},{default:a(()=>[e(n,{modelValue:l.value.planStartTime,"onUpdate:modelValue":t[3]||(t[3]=o=>l.value.planStartTime=o),"max-time":l.value.planEndTime,editable:!1,placeholder:"开始日期",start:"00:00",step:"00:15",end:"23:59",style:{width:"155px","margin-right":"18px"}},null,8,["modelValue","max-time"])]),_:1}),e(m,{prop:"planEndTime"},{default:a(()=>[e(n,{modelValue:l.value.planEndTime,"onUpdate:modelValue":t[4]||(t[4]=o=>l.value.planEndTime=o),"min-time":l.value.planStartTime,editable:!1,placeholder:"结束日期",start:"00:00",step:"00:15",end:"23:59",style:{width:"155px"}},null,8,["modelValue","min-time"])]),_:1})]),_:1}),e(m,null,{default:a(()=>[e(p,{modelValue:l.value.allDay,"onUpdate:modelValue":t[5]||(t[5]=o=>l.value.allDay=o),label:"全天",style:{"margin-right":"20px"},onChange:b},null,8,["modelValue"]),e(p,{modelValue:l.value.repeat,"onUpdate:modelValue":t[6]||(t[6]=o=>l.value.repeat=o),label:"重复",style:{"margin-right":"20px"},onChange:z},null,8,["modelValue"]),Ve,e(S,{modelValue:l.value.repeatDay,"onUpdate:modelValue":t[7]||(t[7]=o=>l.value.repeatDay=o),min:1,disabled:!l.value.repeat},null,8,["modelValue","disabled"])]),_:1}),e(P,null,{default:a(()=>[e(g,{style:J([{"font-size":"12px"},{color:l.value.color}])},{default:a(()=>[_(" 颜色 "),De]),_:1},8,["style"]),e(g,{class:"color-container"},{default:a(()=>[(D(),x(M,null,K(f,o=>s("div",{class:O(["color",o]),onClick:i=>h(o)},null,10,xe)),64))]),_:1})]),_:1})]),_:1},8,["model","rules"])]),e(B,{color:"#474747",onClick:t[8]||(t[8]=o=>$(y.value)),style:{width:"100%"}},{default:a(()=>[we,_("保 存 ")]),_:1})])}}}),Te=H(ke,[["__scopeId","data-v-02b9098d"]]),w=d=>(Q("data-v-d7edfc53"),d=d(),W(),d),Ce={class:"plan-root"},Ee={class:"month"},Se=w(()=>s("div",null,null,-1)),Ie={class:"date-title"},Ue={class:"plan-group"},ze=["onClick"],$e={key:0,class:"plan-title"},Fe=w(()=>s("span",{class:"iconbl bl-a-addline-line"},null,-1)),Pe=[Fe],Be={class:"detail"},Ae={class:"times"},Me=w(()=>s("span",{class:"iconbl bl-date-line"},null,-1)),Re=w(()=>s("span",{class:"iconbl bl-a-clock3-line"},null,-1)),Ye=w(()=>s("i",{class:"iconbl bl-delete-line"},null,-1)),qe=w(()=>s("i",{class:"iconbl bl-a-texteditorsave-line"},null,-1)),Ne=L({__name:"PlanIndex",setup(d){me(()=>{b(re().substring(0,7))});const C=c({});let f="";const y=c(new Date),l=c(),k=u=>{l.value&&l.value.selectDate(u)};ce(()=>y.value,u=>{b(ue(u).substring(0,7))});const b=(u,n=!1)=>{!n&&u==f||(f=u,ve({month:u}).then(p=>{C.value=p.data}))},z=c(),h=c(!1),$=()=>{h.value=!0},F=()=>{b(f,!0),h.value=!1},r=c(!1),t=c({groupId:"",title:"",content:"",planDate:"",planStartTime:"",planEndTime:""}),E=u=>{r.value=!0,t.value=u},T=()=>{be(t.value).then(u=>{b(f,!0),r.value=!1})},m=()=>{de.confirm("是否确定删除该任务","删除任务",{confirmButtonText:"我要删除",cancelButtonText:"取消"}).then(()=>{ye({groupId:t.value.groupId}).then(u=>{b(f,!0),r.value=!1})})};return(u,n)=>{const p=N,S=ie,g=A("bl-row"),P=ne,I=se,B=Y,o=q;return D(),x(M,null,[s("div",Ce,[e(g,{just:"space-between",class:"workbench",height:"45px"},{default:a(()=>[s("div",Ee,V(y.value.getMonth()+1)+"月",1),e(S,{size:"small"},{default:a(()=>[e(p,{onClick:n[0]||(n[0]=i=>k("prev-month"))},{default:a(()=>[_("上月")]),_:1}),e(p,{onClick:n[1]||(n[1]=i=>k("today"))},{default:a(()=>[_("今日")]),_:1}),e(p,{onClick:n[2]||(n[2]=i=>k("next-month"))},{default:a(()=>[_("下月")]),_:1})]),_:1})]),_:1}),e(P,{class:"plan-calendar",modelValue:y.value,"onUpdate:modelValue":n[3]||(n[3]=i=>y.value=i),ref_key:"CalendarRef",ref:l},{header:a(({date:i})=>[Se]),"date-cell":a(({data:i})=>[s("div",Ie,[s("span",null,V(i.day.split("-").slice(2).join("-")),1)]),s("div",Ue,[(D(!0),x(M,null,K(C.value[i.day+" 00:00:00"],(v,X)=>(D(),x("div",{key:v.id,onClick:je=>E(v)},[s("div",{class:O("plan-line "+v.color+" "+v.position+" "+v.hl),style:J({top:X*21+"px"})},[v.position=="head"||v.position=="all"?(D(),x("div",$e,V(v.title),1)):_e("",!0)],6)],8,ze))),128))])]),_:1},8,["modelValue"]),s("div",{class:"module-workbench",onClick:$},Pe)]),e(I,{modelValue:h.value,"onUpdate:modelValue":n[4]||(n[4]=i=>h.value=i),class:"center-drawer",direction:"btt","with-header":!0,"destroy-on-close":!0,size:"470px"},{default:a(()=>[e(Te,{ref_key:"PlanDayInfoRef",ref:z,onSaved:F},null,512)]),_:1},8,["modelValue"]),e(I,{modelValue:r.value,"onUpdate:modelValue":n[7]||(n[7]=i=>r.value=i),class:"center-drawer",direction:"btt","close-on-click-modal":!0,"with-header":!0,"destroy-on-close":!0,size:"270px"},{default:a(()=>[s("div",Be,[e(o,{size:"small",style:{width:"calc(100% - 30px)","margin-bottom":"18px"},modelValue:t.value.title,"onUpdate:modelValue":n[5]||(n[5]=i=>t.value.title=i),placeholder:"计划 标题"},{prefix:a(()=>[e(B,{size:"15"},{default:a(()=>[e(G(j))]),_:1})]),_:1},8,["modelValue"]),e(o,{size:"small",type:"textarea",placeholder:"Todo 内容",modelValue:t.value.content,"onUpdate:modelValue":n[6]||(n[6]=i=>t.value.content=i),resize:"none",rows:4},null,8,["modelValue"]),s("div",Ae,[e(g,{style:{"margin-bottom":"5px"}},{default:a(()=>[Me,_(" "+V(t.value.planDate.substring(0,10)),1)]),_:1}),e(g,null,{default:a(()=>[Re,_(" "+V(t.value.planStartTime)+" - "+V(t.value.planEndTime),1)]),_:1})]),e(g,{class:"btns",just:"center"},{default:a(()=>[e(S,{style:{width:"100%"}},{default:a(()=>[e(p,{color:"#474747",onClick:m,style:{width:"50%"}},{default:a(()=>[Ye,_("删 除")]),_:1}),e(p,{color:"#474747",onClick:T,style:{width:"50%"}},{default:a(()=>[qe,_("保 存")]),_:1})]),_:1})]),_:1})])]),_:1},8,["modelValue"])],64)}}}),nl=H(Ne,[["__scopeId","data-v-d7edfc53"]]);export{nl as default};
