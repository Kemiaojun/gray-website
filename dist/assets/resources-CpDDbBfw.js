var d=Object.defineProperty;var f=(t,s,e)=>s in t?d(t,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[s]=e;var i=(t,s,e)=>(f(t,typeof s!="symbol"?s+"":s,e),e);import{a as g}from"./axios-Cm0UX6qg.js";import{h as m,g as b,L as y,j as h,k as c,u as A,r as R,t as C}from"./index-DDkzpx4-.js";import{E as u}from"./element-plus-COxNbMku.js";const L=m(),j=b();class k{constructor(s){i(this,"instance");i(this,"baseConfig",{baseURL:j,timeout:6e4});this.instance=g.create(Object.assign(this.baseConfig,s)),this.instance.interceptors.request.use(e=>{let a="",o=y.get(h);return c(o)&&c(o.token)&&(a=o.token),e.headers={...e.headers,"Blossom-User-Id":L,Authorization:"Bearer "+a},e},e=>Promise.reject(e)),this.instance.interceptors.response.use(e=>{e.status!==200&&Promise.reject(e);let o=!1;if((e.config.responseType==="blob"||e.headers["content-type"]==="application/force-download")&&(c(e.data.code)?l(e.data.code)||(o=!1):o=!0),l(e.data.code)&&(o=!0),o)return e.data;if(e.data.code==="20002"||e.data.code===20002){console.log("授权失败, 重置登录状态"),A().reset();const p=R.currentRoute.value;return C({name:"Login",query:{redirect:p.name}}),Promise.reject(e)}else{let n=e.data;return n.url=e.config.url,u({message:e.data.message,duration:9999}),Promise.reject(e)}},e=>{let a=e.message;return e.code==="ERR_NETWORK"&&(a="网络错误,请检查您的网络是否通畅"),u({message:a}),Promise.reject(e)})}request(s){return this.instance.request(s)}get(s,e){return this.instance.get(s,e)}post(s,e,a){return this.instance.post(s,e,a)}delete(s,e){return this.instance.delete(s,e)}}const l=t=>t===0||t==="0"||t===2e4||t==="20000",r=new k,E=()=>r.get("/resource/directories"),T=()=>r.get("/resource/types"),v=()=>r.get("/resource/classifications"),B=t=>r.post("/resource/library/add",{...t}),I=t=>r.get("/resource/library/list/"+t),M=t=>r.post("/resource/library/delete/"+t),N=t=>r.post("/resource/library/statistics",t),w=t=>r.post("/resource/library/cover",t),x=t=>r.post("/resource/classify",t),K=t=>r.post("/resource/library/refresh/"+t),O=t=>r.get("/resource/music/"+t),W=t=>r.post("/resource/page",{...t}),z=t=>{const s={headers:{"Content-Type":"multipart/form-data"}};return r.post("/resource/collection/add",t,s)},D=()=>r.get("/resource/collection/list"),_=t=>r.post("/resource/collection/delete/"+t),F=t=>r.post("/resource/delete/"+t);export{I as a,E as b,B as c,M as d,K as e,_ as f,z as g,v as h,x as i,F as j,w as k,D as l,T as m,W as p,O as r,N as s};
